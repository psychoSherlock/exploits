
![ray-so-export(1)](https://github.com/psychoSherlock/exploits/assets/81918189/94feb46e-f301-409c-bfcd-a7371b460073)

# WP Statistics Plugin Unauthenticated SQL Injection (CVE-2022-25149)

This repository contains an exploit for a critical security vulnerability, identified as **CVE-2022-25149**, that was discovered in the WP Statistics Plugin up to version 13.1.5 on WordPress. The vulnerability allows for SQL injection attacks through the manipulation of the `ip` parameter in the file `~/includes/class-wp-statistics-hits.php`.

## Vulnerability Details

- **CVE ID**: CVE-2022-25149
- **CWE**: CWE-89 (SQL Injection)
- **Severity**: Critical
- **Affected Plugin**: WP Statistics Plugin
- **Affected Versions**: up to 13.1.5
- **Vulnerable File**: ~/includes/class-wp-statistics-hits.php
- **Vulnerable Parameters**: ip
- **Google Dork**: inurl:~/includes/class-wp-statistics-hits.php

## Description

The WP Statistics Plugin up to version 13.1.5 on WordPress is susceptible to an unauthenticated SQL injection vulnerability due to insufficient input validation. Specifically, the manipulation of the `ip` parameter can lead to unauthorized execution of SQL queries. This vulnerability arises from the plugin constructing SQL commands using externally influenced input without properly neutralizing special elements that could modify the intended SQL command.

The impact of this vulnerability encompasses confidentiality, integrity, and availability risks to the affected WordPress websites.

## Technical Details

The vulnerability is located in the endpoint `/wp-json/wp-statistics/v2/hit`, which can be exploited when the "Cache Compatibility" setting is enabled in the WP-Statistics plugin. The following parameter is vulnerable to SQL injection:

- `ip`: String-based SQL Injection

## Reproduction Steps

1. Install the WP-Statistics plugin version 13.1.5 from the [WordPress Plugins Repository](https://wordpress.org/plugins/wp-statistics/).
2. Log in to the WordPress dashboard and navigate to WP Statistics > Settings (/wp-admin/admin.php?page=wps_settings_page).
3. Enable the "Cache Compatibility" option.
4. Without authentication, visit any page on the target site.
5. Extract the nonce value for wp-statistics from the response page.
6. Replace `_wpnonce` in the subsequent request.

## Mitigation

To address this vulnerability, update the WP-Statistics plugin to version 13.1.6 or a newer release. This update should include the necessary fixes to prevent the exploitation of the SQL injection vulnerability.

## Additional Information

For more details about the vulnerability and its technical aspects, refer to the advisory shared on [Gist GitHub](https://gist.github.com/Xib3rR4dAr/5dbd58b7f57a5037fe461fba8e696042).

## Author

The security issue was identified by **Muhammad Zeeshan (Xib3rR4dAr)**.

## Plugin Information

- **Plugin Link**: [WP-Statistics](https://wordpress.org/plugins/wp-statistics/)
- **Plugin Active Installations**: 600,000+
- **Current Version**: 13.1.5 (Latest)
- **Vulnerable Endpoint**: /wp-json/wp-statistics/v2/hit
- **Vulnerable File**: /wp-content/plugins/wp-statistics/includes/class-wp-statistics-pages.php:225
- **Vulnerable Parameters**: ip
